<html>
<body>
<a href="Mapper_de.html">deutsche Version</a><p>
<a href="Mapper_app_en.html">Application Information</a><br>
<a href="../index.html">tf Packages (german)</a><br>
<a href="index.html">Mapper Home</a><br>
<a href="#applet">Applet</a><p>
<a href="#new160799">Changes 6/17/99</a><br>
<a href="#new060599">Changes 5/6/99</a><br>
<a href="#new260499">Changes 4/26/99</a><br>
<a href="#new030499">Changes 4/3/99</a><br>
<a href="#new220399">Changes 3/22/99</a><p>
<H3>The DoItYourself Mapper for MUDs written in Java (TM) Alpha Version</H3>
<H5>What for?</H5>
As I am frustrated drawing my maps with a pencil on a sheet of paper I started writing a software tool to make it easier.<br>
The most annoying thing when drawing by hand were:
<li>after having drawn the half map I noticed that some nodes did not fit forcing me to redraw the whole thing
<li>there was no space for adding information to the nodes
<li>if the regions of the mud changed afterwards I had to update, often redraw the maps
<li>the maps (of one mud) are filling a whole notebook, when walking from one map to another I spend my time searching the right map
<p>
thats why I choose to add the following functionality to the mapper:

<H4>implemented:</H4>
<li>maps containing nodes with exits connecting them
<li>its possible to walk through the maps (<a href="#m_jump">mouse</a>/<a href="#exits">direction commands</a>/<a href="#k_move">keypad</a>)
<li><a href="#grafik">3 dimensional map</a> with one z-level displayed and the connections to other z-levels shown
<li>each map can be <a href="#asp">connected</a> to other maps; when choosing the connecting exit the map is automagically switched (the connection to other maps is shown as a <a href="#grafik">yellow rectangle</a> at the end of the exit)
<li>new exits can be created <a href="#k_create">interactively</a> by walking through the map or if multiple exits shall be created by a <a href="#ae">command</a>
<li>special exits which are used by a command (in the map) are <a href="#asp">created</a> with a direction given or a destination point with its map (also the way to connect maps)
<li>its possible to remote control the mapper by issuing commands to a port (application only) (i will add some helper macros for tf)
<li>nodes can be marked using the <a href="#m_mark_rect">mouse</a>
<li><a href="#oneway">one-way</a> exits are possible
<li>there are multiple zoom levels (<a href="#m_zoom">Mouse</a>/<a href="#k_zoom">Keyboard</a>), its possible to <a href="#k_view">move</a> the view of the map without moving the actual node, <a href="#k_center">centering</a> around the actual node
<li>removing of <a href="#DP">nodes</a> and <a href="#DE">exits</a>
<li>its possible to <a href="#ai">add</a> information to any node <a href="#ai_keys">like</a> name, p_short, p_long, node in my routing system, npcs, misc information, if the room was thoroughly examined) which are either <a href="#grafik">visualised</a> within the map or shown in a <a href="#si">infoarea</a> (this information can also be generated by a mud client like tf)
<H5><a name="new220399">
3/22/99</a></H5>
<li>for adding information to a node additional self chosen <a href="#ai">keywords</a> can be used, these are used as title strings in the info area
<li>the commands <a href="#DP>DP</a> (deletePoint), <a href="#DE>DE</a> (deleteExit), <a href="#ae">ae</a> (addExit) now also work on all <a href="#m_mark">marked</a> nodes, just use the option marked
<li>the command <a href="#cgrid">cgrid</a> creates a grid within the map
<li><a href="#exits">most</a> of the usable directions were added (see navigation)
<H5><a name="new030499">
4/3/99</a></H5>
<li>using the command <a href="#ar">ar</a> (addReverse) rooms which have only one exit can easily replace that exit with a special exit with the given name (e.g. out, leave)
<li>the information about npcs, houses, node names, portals, refresh possibilities, pubs, shops do now have a <a href="#grafik">graphical</a> representation</a>within the map
<H5><a name="new260499">
4/26/99</a></H5>
<li>Its now possible to set some options via<a href="#opt">opt</a> (Grid, numbers shown, max npcs level)
<li>demonstration maps which demonstrate the functionality
<li>Moving nodes within and between maps with the command <a href="#MP">MP</a>
<H5><a name="new060599">
5/6/99</a></H5>
<li>creation of nodes at any coordinates with the command <a href="#an">an</a>
<li>splitting of a node into two nodes by exits using <a href="#sn">sn</a>
<li>to force thre replacement of exits (with "!") and the creation of nodes at coordinates already used by another node ("$"), the lenght of newly created exits can be given explicitely with n* <a href="#syntax">see syntax</a>
<li>createion and updating of lpc code with <a href="maps/template.c">template</a> files
<li>saving of the set options and adding of self chosen options see <a href="#opt">opt</a>
<H5><a name="new160799">
7/16/99</a></H5>
<li><a href="#lna">Listing</a> of nodes, which contain a given information keyword or step by step instruction listing for a number of nodes
<li>the nodes which were visited (using tf) or which have information added are marked internally as visited. These visited nodes are <a href="#grafik">displayed</a> as a square in the map.
<li>the internal attributes are saved in the coords file (marked nodes, visited nodes, <a href="#MP">overlapping</a> nodes)
<H4>planned:</H4>
<li>colored polygons in the map
<li>remarks written directyl into the map
<li>recalculation of the nodes when the map is having displaced nodes
<li>integration in the routing system, by choosing a node the character in the mud is walking there
<li>usage for lpc rooms, if wanted lpc code is generated for marked nodes
<li>??your ideas
<p>
<H3>Here is the demo (almost)</H3>
<p>
General Information:
<ul>
<li>Mac: the Alt modifier mentioned is the Option modifier
<li>Mac and everywhere: instead of the right mouse button (you might ask:What right button?) a double click is possible
<li>a virtual machine supporting jdk1.1 is required, there were problems with netscape not finding the class ActionListener used in jdk1.1
</ul>
<a name="grafik"><H3>The graphical Map<H3></a>
<li>the map is displayed on the largest area of the mapper
<li>the sizes of the displayed symbols depend on the zoom factor
<li>the actual node is shown as a green rectangle
<li>if a node was already visited it is displayed as a rectangle (useful for new regions for showing which nodes were not visited by now).
<li>beside the nodes their <a href="#opt">numbers</a> and if available their <a href="#ai">names</a> are displayed (dir ese)
<li>normal exits are drawn middle grey, up exits light grey with a + (dir nne), down exits dark grey with a - (ssw), special exits red (special exits without a direction end dir nnw)
<li>switching between maps is shown by a yellow rectangle at the end of a exit
<li><a href="#ai">npcs</a> are display as little figures (sse), their color is the given level in relation to <a href="#opt">level 50</a>, autoattack npcs are red, normal blue, and blocking npcs are wearing a "shield" (e.g. ai npc Guard (#A#B#L30) where Guard is the name of the npc, #A means autoattack #B means blocking and #L30 is level 30)
<li>existing houses are displayed wsw
<li>the existance of fillUps, pubs, shops is hinted by the letters (FPS) in direction ene
<li>portals/teleporters at the actual node are shown as an arc (wnw)<p>
<li>overlapping nodes are displayed red and a little bit moved off their position (for accessing them or marking)

<H3>Keyboard usage:<H3>
<H4>Keybindings which have immediate effect</H4>
!!All immediate keys does only work if you select the drawing area. If the input field is selected the characters are inserted!<br>
navigation: <br>
<a name="k_move"></a><li>like keypad 1-sw, 2-s, 3-se, 4-w, 6-e, 7-nw, 8-n, 9-ne for the directions, + for up, - for down<br><p>
moving the view:<br>
<a name="k_view"></a><li>Ctrl+navigation keys: Moving the map in x/y/z direction
<a name="k_zoom"></a><li>Ctrl+z: zoom
<a name="k_unzoom"></a>
<li>Ctrl+u: unzoom
<a name="k_center"></a>
<li>Ctrl+c, Ctrl+m: center the map around the actual point<p>
creation:<br>
<a name="k_oneway"></a>
<li><pre>Alt+#</pre> next single exit creation is oneway only
<a name="k_force"></a>
<li><pre>Alt+$</pre> the next node is also created if a node exists at the coordinates <br>
<a name="k_create"></a>
<li><pre>Alt+navigation keys</pre> new exit in the given direction is crated (if there's a node a connection is made otherwise a new node is also created)<p>
marking:<br>
<a name="k_unmark"></a>
<li><pre>Shift+u</pre>removes all markings in the actual map
<H4>Using the mouse</H4>
navigation:<br>
<li><a name="m_jump"></a><pre>right button or double click:</pre>jumping to the clicked node
<li><a name="m_si"></a><pre>left button:</pre>intended for interactive commands meanwhile output of information (screen coordinates, map coordinates, if found the node)<p>
<H4>moving the view:
<li><a name="m_zoom"></a><pre>Ctrl+drag with left button pressed:</pre>draw a zoom rectangle (zoom)
<li><a name="m_unzoom"></a><pre>Ctrl+right button:</pre>one zoom level back (Unzoom)
interaction:
<li><a name="m_mark"></a><pre>Shift+left button:</pre>mark/unmark of nodes
<li><a name="m_mark_rect"></a><pre>Shift+drag left button:</pre>mark the nodes contained in the rectangle
<H4>commands: (option syntax == regexp) </H4>
<a name="syntax"></a>
syntax:
<li>-d(#|x*|$|!)?(name|id): directionname (s e sw single word) or ID (special 0 for exits without a direction e.g. telporter or exits reaching over multiple nodes), 
<ul>
<li>if # is given the direction is only used in oneway (from the (actual) node to the other node) (otherwise both directions are used), when giving -d0 oneway is the default
<li>"x*" with x a number makes the next newly created exit has a length of x units (e.g. -d2*se creates an exit which is two units long to the direction se)
<li>"!" is used if an already exiting exits in the direction shall be overwritten with the new exit. (e.g. exit w to node 5 by exit w to node 28 <a href="#asp">asp</a> -d!w -p28)
<li>"$" allows new nodes to be created at places where a node already exists (problem of overlapping nodes in a map) the new nodes is diplayed <a href="#grafik">specially</a> this is also usable with the command <a href="#an">an</a>
</ul>
<li>-m(name|id) name of the map (single word) or id (listed in title bar)
<li>-p(name|id) name of the node (single word) or id (is shown in the map)
<li>if a node of another map is given the -m option is required
<li>for exits without a direction -d0 has to be used otherwise the direction can be given like -dse (southeast)
<li>if the arguments are given without the mentioned options, than these arguments containing references to exits or nodes do just work for the actual map and no special exists can be used. but even there ids or names are possible (e.g. ae n nw s se u -> addExit north northwest ...)<p>
<li>when using the commands <a href="#ae">ae</a>, <a href="#DP">DP</a>, <a href="#DE">DE</a>, <a href="#MP">MP</a>, <a href="#lpc">lpc</a> the substring of "marked" necessary for identification can be used to have the command work on the marked nodes<br>
navigation:<br>
<a name="exits"></a>
<li>name of the exit/direction: n, se or name of the special exit (e.g. jump up) will result in navigation using the given exit/direction<br>
the following exits are recognized:<br>
sp, sw, ssw, s, sse, se, ese, e, ene, ne, nne, n, nnw, nw, wnw, w, wsw, u, d, swd, sswd, sd, ssed, sed, esed, ed, ened, ned, nned, ne, nnwd, nwd, wnwd, wd, wswd, swu, sswu, su, sseu, seu, eseu, eu, eneu, neu, nneu, nu, nnwu, nwu, wnwu, wu, wswu<br>
special, southwest, southsouthwest, south, southsoutheast, southeast, eastsoutheast, east, eastnortheast, northeast, northnortheast, north, northnorthwest, northwest, westnorthwest, west, westsouthwest, up, down, southwestdown, southsouthwestdown, southdown, southsoutheastdown, southeastdown, eastsoutheastdown, eastdown, eastnortheastdown, northeastdown, northnortheastdown, northdown, northnorthwestdown, northwestdown, westnorthwestdown, westdown, westsouthwestdown, southwestup, southsouthwestup, southup, southsoutheastup, southeastup, eastsoutheastup, eastup, eastnortheastup, northeastup, northnortheastup, northup, northnorthwestup, northwestup, westnorthwestup, westup, westsouthwestup<br>
<li><a name="g"></a><pre>
g (nodename|id)
</pre>jumps to the given node
<li><a name="sm"></a><pre>sm (mapname|id)</pre> (switchMap) switches to the given map, the last aktive node of that map is activated.
create:<br>
<li><a name="asp"></a><pre>asp -d(#|x*|$|!)?(directionid|-name|0) ((-m(mapid|-name))? -p(nodeid|-name))? (special name of the exit)?</pre> (addSpecial) adds the special exit using the given direction (or none if -d0), if no direction is given (-d0) it is required to supply a destination (node and/or map), that special exit gets the command given as last thing (e.g. go upstairs), for the parameters of -d see <a href"#syntax">syntax</a>. It can also be used to create an normal exit to a node which is more than one unit away (asp -ddirection -pnodeid) will do it
<li><a name="ae"></a><pre>ae (((#|x*|$|!)?(directionid|-name)|marked) )+</pre> (addExit) exits are created for all given directions, if neccesary connected to existing nodes or nodes which were just created, with the option marked given all marked nodes are connected with the restriction that one node can only have one exit with the same name (direction). For the <a href="#syntax">(#|x*|$|!) see syntax</a><br>
<li><a name="ar"></a><pre>
ar special exit name
</pre>if the current room has only one exit or one connection from another room the connection is created/replaced with one bearing the given special exit name (e.g. out, leave)
<li><a name="am"></a><pre>am mapname</pre> (addMap) a new map with the given name (single word) is created (if it does not already exist), it already contains the node 0
<li><a name="cgrid"></a><pre>cgrid xpos ypos -sx width (-sy height)? (-di)?<pre>creates a grid within the map, the actual node has the given position in the grid (e.g. (0,0) bottom left, (width-1,height-1) top,right). If height is not given a quadratic grid is created. Givin -di also creates diagonal connection between the nodes.<br>
<li><a name="an"></a><pre>an (-r(nodeid|name)) x y? z? $?</pre>
creates a new node
<ul>
<li>-r if the coordinates give are a relative delta value to the given node, if none given to the actual node. Otherwise (no -r) the coordinates are absolute (!!!multiples of 2)
<li>x y? z? absolute coordinates or delta values, if y,z are not supplied they are set with useful values
<li>$ forces the creation of a new node even if there is already one at the given coordinates.
</ul>
change:<br>
<a name="MP"></a><li><a name="MP"></a><pre>MP (-a(nodeid/-name)?|-r((x*)?directionid/name)?)? (x|dx) (y|dy)? (z|dz)? (-m(mapid|name))? marked?</pre>
Moves the given nodes:
<ul>
<li>the first parameter declares the movement as relative (-r) or absolute (-a). If absolute the node to which the new coordinates shall be given must appear behind the -a parameter (if none given the actual node is used)
<li>if behind -r a direction (with lenght factor) is supplied, this one is used.
<li>after that the new coordinates (to where the nodes are moved) or movement units (by which delta the nodes will be moved) shall appear. the first value is that of the x-direction the others (y/z) can be spared (they will be set to hopefully useful values).<br> Almost all nodes of the map sit on multiples of 2 (except the ones which origin from an exit like ese or nnw).<br>They visibility of the grid can be switched with the <a href="#opt">opt grid</a> command
<li>if a map is given the nodes are moved there and deleted in the actual ma. the connections from nodes of the actual map to the moved nodes will change to map-switch connections
<li>if a substring of marked is given as last parameter, the marked nodes are moved otherwise the actual node will be moved
<li>Examples:<ul>
<li>MP -r2*se : moves the actual node by two units to southeast
<li>MP -a 6 2 : moves the actual node to the coordiantes 6 2 on the actual z level
<li>MP -a0 10 4 8 marked : moves the marked nodes that the node 0 sits on the coordinates 10 4 8 and the other nodes are moved relatively to that
<li>MP -r 4 2 marked : the marked nodes are moved by four units in x direction and by two units in y direction
<li>MP -a  2 2 -mtest marked : the marked nodes will be moved to the map named "test", so that the actual node has the coordinates 2 2 and the z level that was the last used in map "test"
</ul>
</ul>
<li><a name="sn"></a><pre>sn ((directionid|name) )+</pre>splits the actual node into two nodes that the given exits belong to the new node and the remaining are left with the previous one.<br>
Diese Funktionalitaet ist dann von Bedeutung, wenn die Neuberechnung der Maps implementiert ist.<br>
delete:<br>
<li><a name="DE"></a><pre>
DE  ((-d#?(directionid|-name|0) ((-m(mapid|-name))? -p(nodeid|-name))? (name of the exit)?)|(#?(directionid|-name) )+)
</pre> (deleteExit) deletes exits of the actual node for the given directions, a # before a direction causes only the exit from the actual node to be deleted otherwise both exits are deleted<br>
Examples: <ul>
<li>DE n s e : deletes the exits n s e
<li>DE -ds : deletes the exit s
<li>DE -d0 jump : deletes the special exit named "jump"
<li>DE -ds -m1: deletes the exit s which switches to the map number 1
<li>DE -d0 -mtown teleport: deletes the special exit named "teleport" which switches to the map named "town"
<li>the destination nodes may be given, but if they have to be correct
</ul>
<li><a name="DP"></a><pre>
DP ((nodeid/-name|marked) )?
</pre> (deletePoint) deletes the given nodes (if none given the actual node) or the marked nodes and all exits which go from this node(s) and to this node(s) (in all maps). The number of the node(s) is reused if new nodes are created later.
Other:<br>
<li><pre>Q</pre> Quit
<li><a name="lpc></a><pre>lpc (marked|map)?</pre>
creates or updates the lpc-files for the given nodes (marked, whole map or if nothing given for the actual node)
<li>for that a template file is used that is supplied either for the map (named mapmapid_template.c (e.g. map0_template.c)) or for the mud (named <a href="maps/test/template.c">template.c</a> in the mud directory) or one for all muds in the maps directory. The template files are searched in the given order.
<li>the naming conventions for the lpc files are mapname/mapname_nodeid|name.c (e.g. cave/cave_1.c or town/town_center.c)
<li>by now the short and the long descriptions are set (and the other information for that tags exist in the file.
<li>as example for a short description: /*short* to */ in the template is copied, decommented and a // $short$ is inserted before the change. Then #short# will be replaced by the short description.
<li>the exits are created with AddExit, the reference files are referenced as "../map/maplpcfile.c" (e.g. "../town/town_center.c").
<li>if a file for a node already exits it will only be updated
<li>for that the regions between // $short$ and /*short* are deleted and created again. It is important, that changes that should not be deleted must be copied outside that region.
<li>if other tags appear int the template file, and these tags appear as keywords for informations added with <a href="#ai">ai</a> they will also be replaced.
<li>if the tags and keys start with f_ an <a href="#opt">option</a> is searched which has the same name, which is prepended before the information contained in the node. That can be an absolute path and in the information contained in the nodes only the filenames have to appear. E.g. keyword f_bsx: information in the node f_bsx="guard.bsx" option set f_bsx="/d/wonderland/mesirii/bsx" will be concatenated to "/d/wonderland/mesirii/bsx/guard.bsx" and that will be inserted in the template at #f_bsx#.
<ul>
<li><a name="opt"></a><pre>opt ((numbers|grid|vgrid|level maxlevel)|key value?)</pre>
Options: sets or switches the given options (sufficient substring are possible (e.g. opt num)):
<ul>
<li>number Showing the node numbers
<li>grid Showing the coordinate system of the map (the nodes sit on coordinats which are multiples of 2 (except for directions like ssw, ene,...)
<li>vgrid Anzeigen des Koordinatensystems des Bildschirms
<li>level maxlevel Neusetzen des maximalen Levels fuer die Berechnung der NPC Farbe (z.b. opt lev 100)
<li>self chosen keys can also be used. If a value is given it is set or replaced if none given the option will be deleted. The keys are for example used by <a href="#lpc">lpc</a>
<li>the options of the mud are saved into the file map.opts when the application is quit with <a href="#Q">Q</a>. This is a text file which can also be edited.
</ul>
<li><a name="ai"></a><pre>
ai (name|short|long|exa|ways|npc|house|port|tport|tank|pub|shop|selfchoosenkeyword) (text)?
</pre> (addInfo) adds the given information to the actual node, the text ist directly used as string for display, if no text is given the acutal value of the attribute ist deleted. The named keywords are also used <a href="grafik">otherwise</a>, the self choosen keywords (lots of them) not.
<a name="ai_keys"></a><pre>
given keywords:
short, Short
long, Long
npc, NPCs
name, Name
ways, WayNode
exa, fully examined (details of the room)
house, Houses
tport, Teleport
port, Port
shop, Shop
pub, Pub
tank, FillUp
</pre>
<li><a name="si"></a><pre>
si (nodename|-id)?

</pre>shows the information for the given or if none given the actual node<p>
<li><a name="lna"></a><pre>
lna keyword (all|map|level|region dx dy dz)(task)?
</pre>
All nodes which contain the given information keyword are listed with the referred information, if they lie within the region.
region restrictions:<br>
<ul>
<li>all all maps
<li>map actual map
<li>level actual z-level
<li>region dx dy dz the nodes whose distance to the actual node ist less or equal to the deltas (a cube with the double edge lengths)
</ul>
If task is given, the nodes are searched for keywords which start with the given keyword and end with a number. The contents of these keywords is displayed in the order of the numbers with the containing node (and map) behind. If a number was used twice only one of the nodes is considered<br>
Example:<br>
<ul>
<li>lna house map: all nodes with houses in the actual map
<li>lna item reg 5 2 2: all nodes containing the keyword item, which are situated within a cube with the edge lengths of 10,4,4 around the actual node
<li>lna quest all task: all nodes of the complete mud map containing the keywords quest1..questxx in the order of the numbers with information, nodereference, mapinfo
</ul><p>
<a name="applet></a><H4>Here it is finally ;) </H4>
This is a demonstration and testing version only. The final version will be usable as an application or applet (with the known restrictions). But as there are some muds which are very concerned about the free exchange of maps among their users I am still looking for a solution which prevents that.<p>
The maps are demonstration maps which should show the current functionality of the mapper. As nothing is saved you can experiment freely<br>
<applet code="Mapper.class" width=400 height=400>
<param name=path value="http://www.inf.tu-dresden.de/~mh14/tf/map/maps">
<param name=map value="3k.org">
<param name=lang value="en">
Here an applet should be visible.
</applet><p>
Please report all bugs if possible with a dump of the java-console to 
<a
href="mailto:mh14@inf.tu-dresden.de">me</a>. Please check the mapper thouroughly and inform me if you have suggestions for usability or features.
<br><p>
<i>4/29/99 Mesirii</i>
</body>
</html>


